# Upstream Intake Report - 2026-02-15

## 1) Upstream snapshot

- Upstream repo: `https://github.com/openclaw/openclaw`
- Fork repo: `https://github.com/jesseAI-gutsgusto/openclaw`
- Compared refs: `main` vs `upstream/main`
- Ahead/behind at intake start: `1/880`
- Intake scope: `security | runtime | policy | tools | plugins`
- Upstream fetch: `failed (offline)`; `upstream/main` last fetched at `2026-02-15 05:30:27 +0000`

## 2) Why this intake exists

Short reminder:

- Upstream evolves fast and includes fixes we want.
- This fork is B2B single-tenant and intentionally removed some surfaces.
- We import selectively to keep reliability high without reintroducing removed scope.

## 3) Adopted commits

- `fac040cb104b5a3886e84c4a54173122e4d1ce9f` fix (gateway): redact sensitive status details for non-admin scopes
  - reason: Security hardening for status exposure; applies cleanly to gateway status paths we keep.
  - files touched: `src/commands/status.summary.ts`, `src/gateway/server-methods/health.ts`, related tests
  - risk level: `low`
- `a2fe3b66101c34f3e6880139330e411129a51db9` fix (gateway): harden chat.send message input sanitization
  - reason: Security hardening for message ingress; matches our gateway surface.
  - files touched: `src/gateway/server-methods/chat.ts`, related tests
  - risk level: `low`
- `424c718bc5dac6ea3cff4b8eec7d79b9e36f5a93` fix(security): apply tools.fs.workspaceOnly to sandbox file tools
  - reason: Tightens file tool access to workspace; aligns with B2B security posture.
  - files touched: `src/agents/pi-tools.ts`, related tests
  - risk level: `medium` (behavior change if any workflows rely on non-workspace paths)
- `914b9d1e79964f908f5bfa9871d05e357dc6bd89` fix(agents): block workspaceOnly apply_patch delete symlink escape
  - reason: Prevents symlink escape in apply_patch; critical to keep containment guarantees.
  - files touched: `src/agents/apply-patch.ts`, `src/agents/sandbox-paths.ts`, related tests
  - risk level: `low`
- `4a44da7d91f0305eae919a527f00cab0819bf901` fix(security): default apply_patch workspace containment
  - reason: Defaults apply_patch to workspace boundaries; aligns with our sandbox policy.
  - files touched: `src/agents/apply-patch.ts`, `src/agents/pi-tools.ts`, `src/config/schema.help.ts`, docs/tests
  - risk level: `medium` (possible behavior change for legacy paths; doc updates needed)
- `a7eb0dd9a54c5ded8e49b04b90fe987773f5f730` fix(security): harden Windows child process spawning
  - reason: Process spawning hardening; reduces attack surface on Windows installs.
  - files touched: `src/process/exec.ts`, `src/tui/tui-local-shell.ts`, related tests
  - risk level: `low`
- `86a156db2627d68fb00b320c9ef7ca508a2a0df9` fix (media-understanding): treat binary application mimes as non-text
  - reason: Prevents binary misclassification and unsafe text handling.
  - files touched: `src/media-understanding/apply.ts`
  - risk level: `low`
- `d6f1e7ae9571c78e6a29022334f89547b5cf1af3` fix (auto-reply/queue): preserve queued items on drain retries
  - reason: Runtime stability; avoids lost replies on retry paths.
  - files touched: `src/auto-reply/reply/queue/drain.ts`, related tests
  - risk level: `low`

## 4) Ported changes (manual rewrite)

- None this run. All candidates above look like clean cherry-picks; validate after upstream fetch is restored.

## 5) Skipped commits

- `3faf5ada2e4d28823afad55ccaa1c5a3cfceec02` ci(test): raise node heap for CI vitest
  - reason: `out-of-scope` (CI-only tuning; does not affect runtime behavior)
  - revisit later: `no`
- `8725c2b19ff6a989b6661855527fe730c080ef3f` style(swift): run swiftformat + swiftlint autocorrect
  - reason: `out-of-scope` (style-only change; no runtime/security impact)
  - revisit later: `no`
- `379b445582a270bf35b1800c66c0d8cc19e6df6e` chore: bump version to 2026.2.15
  - reason: `out-of-scope` (versioning handled in our release flow)
  - revisit later: `no`
- `f832f3dcc3f53c7996c295fc4b822349fdc4deb5` chore(mac): update appcast for 2026.2.14
  - reason: `removed-surface` (mac appcast handled separately in our release process)
  - revisit later: `no`

## 6) Validation results

- `pnpm check`: `not run (report-only)`
- `pnpm test`: `not run (report-only)`
- Targeted runtime checks:
  - gateway lifecycle: `not run (report-only)`
  - tool invoke + policy trace: `not run (report-only)`
  - Slack baseline: `not run (report-only)`
  - Teams baseline: `not run (report-only)`
  - webhook ingest baseline: `not run (report-only)`

## 7) Risks and follow-ups

- Risk: apply_patch and file tools are tightened to workspace-only by default; legacy scripts may rely on broader paths.
  - mitigation: verify customer deployments with non-workspace paths; add explicit config override guidance if required.
  - owner: platform
  - due date: 2026-02-18
- Risk: upstream fetch failed, so commit list may be stale.
  - mitigation: rerun intake once network is restored and revalidate ahead/behind counts.
  - owner: platform
  - due date: 2026-02-16

## 8) Next PR plan

1. `Security: workspace-only tools + apply_patch containment` - platform - ETA 2026-02-18
2. `Gateway: status redaction + chat.send sanitization` - platform - ETA 2026-02-19
3. `Runtime: auto-reply queue retry preservation + media MIME hardening` - platform - ETA 2026-02-20
